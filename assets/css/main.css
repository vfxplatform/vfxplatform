@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    scroll-behavior: smooth;
    line-height: 1.6;
    font-feature-settings: 'cv01', 'cv02';
  }
}

@layer components {
  /* Platform table styles */
  .platform-table {
    @apply w-full text-sm;
    border-collapse: separate;
    border-spacing: 0;
  }

  .platform-table th {
    @apply px-4 py-3 text-center text-base font-bold text-white dark:text-gray-200 border-b-2 border-blue-700 dark:border-blue-900 bg-blue-600 dark:bg-blue-800;
  }

  .platform-table th:first-child {
    @apply text-left;
  }

  .platform-table td {
    @apply px-4 py-3 text-center border-b border-gray-100 dark:border-gray-800;
  }

  .platform-table td:first-child {
    @apply text-left;
  }

  .platform-table td.version-changed {
    @apply text-blue-600 dark:text-blue-400;
  }

  .platform-table tr.row-alt td {
    @apply bg-gray-50 dark:bg-gray-800/30;
  }

  .platform-table .category-header td {
    @apply font-bold text-left text-sm tracking-wider text-gray-800 dark:text-gray-200 bg-gray-200 dark:bg-gray-700/70 border-b border-gray-300 dark:border-gray-600 py-2;
  }

  .platform-table-wrapper {
    @apply border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden;
  }

  /* Comparison highlighting - target td cells, excluding category cells with rowspan */
  .diff-changed td:not([rowspan]) {
    @apply bg-yellow-100 dark:bg-yellow-900/30 font-medium;
  }

  .diff-added td:not([rowspan]) {
    @apply bg-green-100 dark:bg-green-900/30;
  }

  .diff-removed td:not([rowspan]) {
    @apply bg-red-100 dark:bg-red-900/30;
  }

  .diff-unchanged td:not([rowspan]) {
    /* No special styling - inherits default */
  }

  /* Filter toggle buttons */
  .diff-filter {
    @apply opacity-40 select-none;
  }

  .diff-filter:hover {
    @apply opacity-70;
  }

  .diff-filter.active {
    @apply opacity-100 ring-1 ring-gray-400 dark:ring-gray-500 bg-gray-50 dark:bg-gray-800;
  }

  /* Ensure component name column stays left-aligned in comparison table (rowspan shifts td:first-child) */
  .platform-table td.comp-name {
    @apply text-left;
  }

  /* Year cards for history page */
  .year-card {
    @apply border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden;
  }

  .year-card-header {
    @apply bg-gray-100 dark:bg-gray-800 px-4 py-3 flex justify-between items-center;
  }

  .year-card-content {
    @apply p-4 space-y-2;
  }

  .year-card-section {
    @apply rounded-lg px-3 py-1;
  }

  .year-card-table {
    @apply w-full text-sm;
  }

  .year-card-table td {
    @apply py-1 px-2;
  }

  .year-card-table td:first-child {
    @apply text-left;
  }

  .year-card-table td:last-child {
    @apply text-right whitespace-nowrap;
  }

  /* Note cards */
  .note-card {
    @apply border border-gray-200 dark:border-gray-700 rounded-lg p-5 mb-6;
  }

  .note-card-title {
    @apply font-semibold text-gray-900 dark:text-gray-100 mb-2;
  }

  /* Note popover (desktop) */
  .note-popover {
    @apply absolute z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl p-5 max-w-[400px] max-h-[60vh] overflow-y-auto;
    animation: note-fade-in 0.15s ease-out;
  }

  .note-popover-arrow {
    @apply absolute w-0 h-0;
  }

  .note-popover-arrow.arrow-top {
    top: -6px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid theme('colors.gray.200');
    filter: drop-shadow(0 -1px 0 theme('colors.gray.200'));
  }

  :is(.dark) .note-popover-arrow.arrow-top {
    border-bottom-color: theme('colors.gray.700');
    filter: drop-shadow(0 -1px 0 theme('colors.gray.700'));
  }

  .note-popover-arrow.arrow-bottom {
    bottom: -6px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid theme('colors.gray.200');
    filter: drop-shadow(0 1px 0 theme('colors.gray.200'));
  }

  :is(.dark) .note-popover-arrow.arrow-bottom {
    border-top-color: theme('colors.gray.700');
    filter: drop-shadow(0 1px 0 theme('colors.gray.700'));
  }

  /* Note backdrop (mobile) */
  .note-backdrop {
    @apply fixed inset-0 z-40 bg-black/0 transition-colors duration-200;
  }

  .note-backdrop.active {
    @apply bg-black/50;
  }

  /* Note bottom sheet (mobile) */
  .note-bottom-sheet {
    @apply fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 rounded-t-2xl shadow-2xl p-5 pt-8 max-h-[70vh] overflow-y-auto;
    transform: translateY(100%);
    transition: transform 0.25s ease-out;
  }

  .note-bottom-sheet.active {
    transform: translateY(0);
  }

  /* Close button for popover/sheet */
  .note-close-btn {
    @apply absolute top-2 right-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 text-xl leading-none cursor-pointer bg-transparent border-none p-1;
  }

  @keyframes note-fade-in {
    from { opacity: 0; transform: translateY(4px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Section heading with flanking lines */
  .section-heading {
    @apply flex items-center gap-4 mb-8;
  }

  .section-heading::before,
  .section-heading::after {
    content: '';
    @apply flex-1 h-px bg-gray-200 dark:bg-gray-700;
  }

  .section-heading h2 {
    @apply text-2xl font-semibold whitespace-nowrap;
  }

  /* Useful links - flex layout with centered last row */
  .useful-links-grid {
    @apply flex flex-wrap justify-center;
    gap: 1rem;
  }

  .useful-links-grid > * {
    width: 100%;
  }

  @media (min-width: 640px) {
    .useful-links-grid > * {
      width: calc(50% - 0.5rem);
    }
  }

  @media (min-width: 1024px) {
    .useful-links-grid > * {
      width: calc(33.333% - 0.6667rem);
    }
  }

  /* Info box */
  .info-box {
    @apply bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800/30 rounded-lg p-5;
  }

  /* Accordion styles */
  .accordion-item {
    @apply border border-gray-200 dark:border-gray-700 rounded-lg mb-2;
  }

  .accordion-header {
    @apply w-full px-4 py-3 text-left font-medium flex justify-between items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors;
  }

  .accordion-content {
    @apply px-4 pb-4 prose dark:prose-invert max-w-none;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}
